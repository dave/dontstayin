// Generator.js
(function($){
Type.registerNamespace('Js.Controls.Banners.Generator');Js.Controls.Banners.Generator.BannerRenderInfoType=function(){};Js.Controls.Banners.Generator.BannerRenderInfoType.prototype = {flash:1,html:2}
Js.Controls.Banners.Generator.BannerRenderInfoType.registerEnum('Js.Controls.Banners.Generator.BannerRenderInfoType',false);Js.Controls.Banners.Generator.BannerRenderInfo=function(){}
Js.Controls.Banners.Generator.BannerRenderInfo.prototype={bannerRenderInfoType:0,k:0,flashUrl:null,height:0,width:0,html:null,duration:0,miscNeedsClickHelper:false,flashVersion:null,linkTag:null,targetTag:null}
Js.Controls.Banners.Generator.Controller=function(view){this.$0=view;this.$2=parseInt(this.$0.get_uiPosition().value);this.$1=parseInt(this.$0.get_uiDuration().value);if(this.$0.get_uiK().value.length>0){this.$11=parseInt(this.$0.get_uiK().value);this.$D();}window.setInterval(ss.Delegate.create(this,this.$B),15000);if(!Js.Controls.Banners.Generator.Controller.$5){$(window).keydown(ss.Delegate.create(this,this.$8)).scroll(ss.Delegate.create(this,this.$8));$(document).click(ss.Delegate.create(this,this.$8));Js.Controls.Banners.Generator.Controller.$5=true;}this.$6=parseInt(this.$0.get_uiInactivityTimeoutDuration().value);this.$7=Js.Controls.Banners.Generator.Controller.refreshAllBanners;Js.Controls.Banners.Generator.Controller.refreshAllBanners=ss.Delegate.create(this,function(){
this.$F();if(this.$7!=null){this.$7();}});}
Js.Controls.Banners.Generator.Controller.prototype={$0:null,$1:0,$2:0,$3:0,$6:0,$7:null,$8:function($p0){Js.Library.Trace.write('User action');this.$C();},$A:false,$B:function(){Js.Controls.Banners.Generator.Controller.$9+=15000;if(!this.$A&&this.$6<Js.Controls.Banners.Generator.Controller.$9){Js.Library.Trace.write('User inactive. Stopping banner rotation');window.clearTimeout(this.$3);this.$A=true;}},$C:function(){Js.Controls.Banners.Generator.Controller.$9=0;if(this.$A){Js.Library.Trace.write('User active. Active banner rotation');this.$D();}},$D:function(){this.$A=false;if(this.$1>0){this.$3=window.setTimeout(ss.Delegate.create(this,this.$E),this.$1);}},$E:function(){Js.Library.Trace.write('Requesting new banners');if(this.$10()){this.$F();}else{this.$D();}},$F:function(){if(this.$2!==1&&this.$2!==2&&this.$2!==5){return;}try{window.clearTimeout(this.$3);Js.Controls.Banners.Generator.Service.getBanner(this.$2,this.$0.get_uiPlaceKs().value,this.$0.get_uiMusicTypes().value,ss.Delegate.create(this,this.$12),Js.Library.Trace.webServiceFailure,null,5000);}catch($0){Js.Library.Trace.write($0.toString());Js.Library.Trace.write($0.message);}},$10:function(){var $0=document.body.scrollTop;return $0<this.$0.get_uiBannerJ().offset().top+this.$0.get_uiBannerJ().height();},$11:0,$12:function($p0,$p1,$p2){if($p0!=null){if(this.$11!==$p0.k){this.$1=$p0.duration;this.$0.get_uiBannerJ().unbind('mouseover');if($p0.bannerRenderInfoType===1){var $0=this.$0.get_uiBanner().id;var $1=new SWFObject($p0.flashUrl,$0+'_movie',$p0.width,$p0.height,$p0.flashVersion,'#ffffff');$1.addParam('wmode','transparent');$1.addParam('AllowScriptAccess','always');$1.addVariable('targetTag',$p0.targetTag);$1.addVariable('linkTag',$p0.linkTag);$1.addParam('loop','true');$1.addParam('menu','false');$1.write($0);if($p0.miscNeedsClickHelper){Js.Library.Trace.write('linkTag'+$p0.linkTag);var $2=document.createElement('DIV');$2.style.left=(0+parseInt(this.$0.get_uiClickHelperLeft().value))+'px';$2.style.top=(0+parseInt(this.$0.get_uiClickHelperLeft().value))+'px';$2.style.position='absolute';$2.style.zIndex=1;var $3=document.createElement('A');$3.href=$p0.linkTag;$3.target=$p0.targetTag;$3.style.border='solid 0px black';$3.className='NoStyle';var $4=document.createElement('IMG');$4.style.width=$p0.width+'px';$4.style.height=$p0.height+'px';$4.style.border='solid 0px black';$4.style.display='block';$4.src='/gfx/1pix.gif';$3.appendChild($4);$2.appendChild($3);this.$0.get_uiBanner().appendChild($2);}this.$11=$p0.k;}else{document.getElementById(this.$0.get_uiBanner().id).innerHTML=$p0.html;}this.$0.get_uiBannerJ().mouseover(ss.Delegate.create(this,this.$13));}}else{}this.$D();},$13:function($p0){window.clearTimeout(this.$3);this.$0.get_uiBannerJ().unbind('mouseover');}}
Js.Controls.Banners.Generator.Service=function(){}
Js.Controls.Banners.Generator.Service.getBanner=function(positionAsInt,relevantPlacesCsv,relevantMusicTypesCsv,success,failure,userContext,timeout){var $0={};$0['positionAsInt']=positionAsInt;$0['relevantPlacesCsv']=relevantPlacesCsv;$0['relevantMusicTypesCsv']=relevantMusicTypesCsv;var $1=Js.Library.WebServiceHelper.options('GetBanner','/WebServices/Controls/Banners/Generator/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'GetBanner');};$.ajax($1);}
Js.Controls.Banners.Generator.View=function(clientId){this.clientId=clientId;}
Js.Controls.Banners.Generator.View.prototype={clientId:null,get_holder:function(){if(this.$0==null){this.$0=document.getElementById(this.clientId+'_Holder');}return this.$0;},$0:null,get_holderJ:function(){if(this.$1==null){this.$1=$('#'+this.clientId+'_Holder');}return this.$1;},$1:null,get_uiBanner:function(){if(this.$2==null){this.$2=document.getElementById(this.clientId+'_uiBanner');}return this.$2;},$2:null,get_uiBannerJ:function(){if(this.$3==null){this.$3=$('#'+this.clientId+'_uiBanner');}return this.$3;},$3:null,get_uiPosition:function(){if(this.$4==null){this.$4=document.getElementById(this.clientId+'_uiPosition');}return this.$4;},$4:null,get_uiPositionJ:function(){if(this.$5==null){this.$5=$('#'+this.clientId+'_uiPosition');}return this.$5;},$5:null,get_uiK:function(){if(this.$6==null){this.$6=document.getElementById(this.clientId+'_uiK');}return this.$6;},$6:null,get_uiKJ:function(){if(this.$7==null){this.$7=$('#'+this.clientId+'_uiK');}return this.$7;},$7:null,get_uiMusicTypes:function(){if(this.$8==null){this.$8=document.getElementById(this.clientId+'_uiMusicTypes');}return this.$8;},$8:null,get_uiMusicTypesJ:function(){if(this.$9==null){this.$9=$('#'+this.clientId+'_uiMusicTypes');}return this.$9;},$9:null,get_uiPlaceKs:function(){if(this.$A==null){this.$A=document.getElementById(this.clientId+'_uiPlaceKs');}return this.$A;},$A:null,get_uiPlaceKsJ:function(){if(this.$B==null){this.$B=$('#'+this.clientId+'_uiPlaceKs');}return this.$B;},$B:null,get_uiDuration:function(){if(this.$C==null){this.$C=document.getElementById(this.clientId+'_uiDuration');}return this.$C;},$C:null,get_uiDurationJ:function(){if(this.$D==null){this.$D=$('#'+this.clientId+'_uiDuration');}return this.$D;},$D:null,get_uiInactivityTimeoutDuration:function(){if(this.$E==null){this.$E=document.getElementById(this.clientId+'_uiInactivityTimeoutDuration');}return this.$E;},$E:null,get_uiInactivityTimeoutDurationJ:function(){if(this.$F==null){this.$F=$('#'+this.clientId+'_uiInactivityTimeoutDuration');}return this.$F;},$F:null,get_uiClickHelperLeft:function(){if(this.$10==null){this.$10=document.getElementById(this.clientId+'_uiClickHelperLeft');}return this.$10;},$10:null,get_uiClickHelperLeftJ:function(){if(this.$11==null){this.$11=$('#'+this.clientId+'_uiClickHelperLeft');}return this.$11;},$11:null,get_uiClickHelperTop:function(){if(this.$12==null){this.$12=document.getElementById(this.clientId+'_uiClickHelperTop');}return this.$12;},$12:null,get_uiClickHelperTopJ:function(){if(this.$13==null){this.$13=$('#'+this.clientId+'_uiClickHelperTop');}return this.$13;},$13:null}
Js.Controls.Banners.Generator.BannerRenderInfo.registerClass('Js.Controls.Banners.Generator.BannerRenderInfo');Js.Controls.Banners.Generator.Controller.registerClass('Js.Controls.Banners.Generator.Controller');Js.Controls.Banners.Generator.Service.registerClass('Js.Controls.Banners.Generator.Service');Js.Controls.Banners.Generator.View.registerClass('Js.Controls.Banners.Generator.View');Js.Controls.Banners.Generator.Controller.$5=false;Js.Controls.Banners.Generator.Controller.refreshAllBanners=null;Js.Controls.Banners.Generator.Controller.$9=0;})(jQuery);// This script was generated using Script# v0.7.4.0
