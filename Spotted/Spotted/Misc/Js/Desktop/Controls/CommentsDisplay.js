// CommentsDisplay.js
(function($){
Type.registerNamespace('Js.Controls.CommentsDisplay');Js.Controls.CommentsDisplay.Service=function(){}
Js.Controls.CommentsDisplay.Service.getThreadComments=function(threadK,pageNumber,getCommentsOnly,success,failure,userContext,timeout){var $0={};$0['threadK']=threadK;$0['pageNumber']=pageNumber;$0['getCommentsOnly']=getCommentsOnly;var $1=Js.Library.WebServiceHelper.options('GetThreadComments','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'GetThreadComments');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.lolAtComment=function(commentK,success,failure,userContext,timeout){var $0={};$0['commentK']=commentK;var $1=Js.Library.WebServiceHelper.options('LolAtComment','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'LolAtComment');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.deleteComment=function(commentK,success,failure,userContext,timeout){var $0={};$0['commentK']=commentK;var $1=Js.Library.WebServiceHelper.options('DeleteComment','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'DeleteComment');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.setThreadUsr=function(threadK,page,success,failure,userContext,timeout){var $0={};$0['threadK']=threadK;$0['page']=page;var $1=Js.Library.WebServiceHelper.options('SetThreadUsr','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'SetThreadUsr');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.createNewThreadInGroup=function(groupK,discussableObjectType,discussableObjectK,duplicateGuid,rawCommentHtml,formatting,isNews,inviteUsrOptions,isPrivate,success,failure,userContext,timeout){var $0={};$0['groupK']=groupK;$0['discussableObjectType']=discussableObjectType;$0['discussableObjectK']=discussableObjectK;$0['duplicateGuid']=duplicateGuid;$0['rawCommentHtml']=rawCommentHtml;$0['formatting']=formatting;$0['isNews']=isNews;$0['inviteUsrOptions']=inviteUsrOptions;$0['isPrivate']=isPrivate;var $1=Js.Library.WebServiceHelper.options('CreateNewThreadInGroup','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'CreateNewThreadInGroup');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.createPrivateThread=function(discussableObjectType,discussableObjectK,duplicateGuid,rawCommentHtml,formatting,inviteUsrOptions,isSealed,success,failure,userContext,timeout){var $0={};$0['discussableObjectType']=discussableObjectType;$0['discussableObjectK']=discussableObjectK;$0['duplicateGuid']=duplicateGuid;$0['rawCommentHtml']=rawCommentHtml;$0['formatting']=formatting;$0['inviteUsrOptions']=inviteUsrOptions;$0['isSealed']=isSealed;var $1=Js.Library.WebServiceHelper.options('CreatePrivateThread','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'CreatePrivateThread');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.createReply=function(discussableObjectType,discussableObjectK,threadK,duplicateGuid,rawCommentHtml,formatting,lastKnownCommentK,inviteUsrOptions,success,failure,userContext,timeout){var $0={};$0['discussableObjectType']=discussableObjectType;$0['discussableObjectK']=discussableObjectK;$0['threadK']=threadK;$0['duplicateGuid']=duplicateGuid;$0['rawCommentHtml']=rawCommentHtml;$0['formatting']=formatting;$0['lastKnownCommentK']=lastKnownCommentK;$0['inviteUsrOptions']=inviteUsrOptions;var $1=Js.Library.WebServiceHelper.options('CreateReply','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'CreateReply');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.createNewPublicThread=function(discussableObjectType,discussableObjectK,duplicateGuid,rawCommentHtml,formatting,isNews,inviteUsrOptions,success,failure,userContext,timeout){var $0={};$0['discussableObjectType']=discussableObjectType;$0['discussableObjectK']=discussableObjectK;$0['duplicateGuid']=duplicateGuid;$0['rawCommentHtml']=rawCommentHtml;$0['formatting']=formatting;$0['isNews']=isNews;$0['inviteUsrOptions']=inviteUsrOptions;var $1=Js.Library.WebServiceHelper.options('CreateNewPublicThread','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'CreateNewPublicThread');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.createPublicThread=function(discussableObjectType,discussableObjectK,duplicateGuid,rawCommentHtml,formatting,isNews,inviteUsrOptions,success,failure,userContext,timeout){var $0={};$0['discussableObjectType']=discussableObjectType;$0['discussableObjectK']=discussableObjectK;$0['duplicateGuid']=duplicateGuid;$0['rawCommentHtml']=rawCommentHtml;$0['formatting']=formatting;$0['isNews']=isNews;$0['inviteUsrOptions']=inviteUsrOptions;var $1=Js.Library.WebServiceHelper.options('CreatePublicThread','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'CreatePublicThread');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.getNewGuid=function(success,failure,userContext,timeout){var $0={};var $1=Js.Library.WebServiceHelper.options('GetNewGuid','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'GetNewGuid');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.cleanHtml=function(html,success,failure,userContext,timeout){var $0={};$0['html']=html;var $1=Js.Library.WebServiceHelper.options('CleanHtml','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'CleanHtml');};$.ajax($1);}
Js.Controls.CommentsDisplay.Service.getPreviewHtml=function(previewType,rawCommentHtml,formatting,success,failure,userContext,timeout){var $0={};$0['previewType']=previewType;$0['rawCommentHtml']=rawCommentHtml;$0['formatting']=formatting;var $1=Js.Library.WebServiceHelper.options('GetPreviewHtml','/WebServices/Controls/CommentsDisplay/Service.asmx',$0,failure,userContext,timeout);$1.success=function($p1_0,$p1_1,$p1_2){
success(($p1_0)['d'],userContext,'GetPreviewHtml');};$.ajax($1);}
Js.Controls.CommentsDisplay.ThreadCommentsProvider=function(commentsPerPage){this.$0=commentsPerPage;this.$4=[];this.$3=[];this.$6=[];this.$8=[];this.$9=[];this.$A=[];this.$7=[];}
Js.Controls.CommentsDisplay.ThreadCommentsProvider.prototype={$0:0,$1:0,get_threadK:function(){return this.$1;},set_threadK:function(value){this.$1=value;return value;},$2:0,get_pageNumber:function(){return this.$2;},set_pageNumber:function(value){this.$2=value;return value;},$3:null,get_initialComment:function(){return this.$3[this.$1];},set_initialComment:function(value){this.$3[this.$1]=value;return value;},$4:null,get_comments:function(){return this.$5(this.$1,this.$2);},set_comments:function(value){if(this.$4[this.$1]==null){this.$4[this.$1]=[];}(this.$4[this.$1])[this.$2]=value;return value;},$5:function($p0,$p1){if(this.$4[$p0]==null){return null;}if((this.$4[$p0])[$p1]==null){return null;}return (this.$4[$p0])[$p1];},$6:null,get_lastPage:function(){return (this.$6[this.$1]!=null)?this.$6[this.$1]:0;},set_lastPage:function(value){this.$6[this.$1]=value;return value;},$7:null,get_lastKnownCommentK:function(){return (this.$7[this.$1]!=null)?this.$7[this.$1]:0;},set_lastKnownCommentK:function(value){this.$7[this.$1]=value;return value;},$8:null,get_firstUnreadPage:function(){return (this.$8[this.$1]!=null)?this.$8[this.$1]:0;},set_firstUnreadPage:function(value){this.$8[this.$1]=value;return value;},$9:null,get_viewComments:function(){return (this.$9[this.$1]!=null)?this.$9[this.$1]:0;},set_viewComments:function(value){this.$9[this.$1]=value;return value;},$A:null,get_totalComments:function(){return (this.$A[this.$1]!=null)?this.$A[this.$1]:0;},set_totalComments:function(value){this.$A[this.$1]=value;return value;},onLoaded:null,onThreadCreated:null,appendComment:function(newComment){if(this.get_pageNumber()!==this.get_lastPage()){this.set_pageNumber(this.get_lastPage());}if(!this.$1){this.$1=newComment.threadK;}if(this.get_comments()==null){this.set_comments([newComment]);}else if(this.get_comments().length===this.$0){this.$2++;this.set_lastPage(this.get_lastPage()+1)-1;this.set_comments([newComment]);}else{this.get_comments()[this.get_comments().length]=newComment;}},appendComments:function(newComments){for(var $0=0;$0<newComments.length;$0++){this.appendComment(newComments[$0]);}},loadThreadComments:function(){if(this.$1>0){if(this.get_comments()==null){this.$B();}else{this.$E();}}},reloadThreadComments:function(threadK,pageNumber){this.$1=threadK;this.$2=pageNumber;this.$B();},$B:function(){Js.Controls.CommentsDisplay.Service.getThreadComments(this.$1,this.$2,((this.get_initialComment()!=null)?true:false)&&(this.get_lastPage()>0),ss.Delegate.create(this,this.$C),ss.Delegate.create(this,this.$D),null,-1);},$C:function($p0,$p1,$p2){this.$2=$p0.currentPage;this.set_comments($p0.comments);if(this.get_initialComment()==null){this.set_initialComment(($p0.initialComment!=null)?$p0.initialComment:$p0.comments[0]);}if(!this.get_lastPage()){this.set_lastPage($p0.lastPage);}if(!this.get_firstUnreadPage()){this.set_firstUnreadPage($p0.firstUnreadPage);}if(!this.get_totalComments()){this.set_totalComments($p0.totalComments);}if(!this.get_viewComments()){this.set_viewComments($p0.viewComments);}this.$17($p0.comments[$p0.comments.length-1].k);this.$E();Js.Controls.CommentsDisplay.Service.setThreadUsr(this.$1,this.$2,null,null,null,-1);},$D:function($p0,$p1,$p2){this.$2=0;this.set_comments(null);this.set_firstUnreadPage(0);this.set_initialComment(null);this.set_lastKnownCommentK(0);this.set_lastPage(0);this.set_totalComments(0);this.set_viewComments(0);this.$E();},$E:function(){if(this.onLoaded!=null){this.onLoaded(this,ss.EventArgs.Empty);}},commentsAnchorName:null,$F:function($p0){$p0.preventDefault();this.$10();this.$2--;this.loadThreadComments();Js.Library.Misc.redirectToAnchor(this.commentsAnchorName);},$10:function(){Js.Controls.Banners.Generator.Controller.refreshAllBanners();},$11:function($p0){$p0.preventDefault();this.$10();this.$2++;this.loadThreadComments();Js.Library.Misc.redirectToAnchor(this.commentsAnchorName);},$12:function($p0){$p0.preventDefault();this.$10();this.$2=$p0.target.getAttribute('pagenumber');this.loadThreadComments();Js.Library.Misc.redirectToAnchor(this.commentsAnchorName);},createPrevNextPaging:function(){var $0=document.createElement('p');$0.style.textAlign='right';var $1=document.createElement('a');var $2=document.createElement('img');$2.src='/gfx/icon-back-12.png';$2.style.border='0';$2.style.verticalAlign='middle';$1.appendChild($2);var $3=document.createElement('span');$3.innerHTML='prev page';$1.appendChild($3);if(this.$2>1&&this.get_lastPage()>1){$1.href='#';$($1).click(ss.Delegate.create(this,this.$F));}else{$1.disabled=true;$1.className='DisabledAnchor';}$0.appendChild($1);var $4=document.createElement('span');$4.innerHTML='&nbsp;...&nbsp;';$0.appendChild($4);var $5=document.createElement('a');var $6=document.createElement('span');$6.innerHTML='next page';$5.appendChild($6);var $7=document.createElement('img');$7.src='/gfx/icon-forward-12.png';$7.style.border='0';$7.style.verticalAlign='middle';$5.appendChild($7);if(this.$2<this.get_lastPage()){$5.href='#';$($5).click(ss.Delegate.create(this,this.$11));}else{$5.disabled=true;$5.className='DisabledAnchor';}$0.appendChild($5);return $0;},createNumberedPaging:function(){var $0=document.createElement('p');var $1=document.createElement('span');$1.innerHTML='Pages: ';$0.appendChild($1);var $2=this.$13();var $3=false;for(var $4=1;$4<=this.get_lastPage();$4++){if($2[$4]){var $5=this.get_firstUnreadPage()>0&&this.get_firstUnreadPage()<=$4&&this.get_viewComments()<this.get_totalComments();var $6;if($4===this.$2){$6=document.createElement('span');$6.className=($5)?'CurrentPageUnread':'CurrentPage';}else{$6=document.createElement('a');$6.setAttribute('pagenumber',$4);($6).href='#Comments';$($6).click(ss.Delegate.create(this,this.$12));if($5){$6.className='Unread';}}$6.innerHTML=$4.toString();$0.appendChild($6);var $7=document.createElement('span');$7.innerHTML='&nbsp;';$0.appendChild($7);$3=false;}else{if(!$3){var $8=document.createElement('span');$8.innerHTML='...&nbsp;';if(this.get_firstUnreadPage()>0&&$4>this.get_firstUnreadPage()){$8.className='Unread';}$0.appendChild($8);$3=true;}}}return $0;},$13:function(){var $0=3;var $1=4;var $2=2;var $3=new Array(this.get_lastPage()+1);this.$14($3,1,$0);this.$14($3,this.get_lastPage()-$0+1,this.get_lastPage());if(this.get_firstUnreadPage()>0){this.$14($3,this.get_firstUnreadPage()-$2,this.get_firstUnreadPage()+$2-1);}this.$14($3,this.$2-$1,this.$2+$1);for(var $4=1;$4<$3.length-1;$4++){if(!!$3[$4-1]&&!$3[$4]&&!!$3[$4+1]){$3[$4]=true;}}return $3;},$14:function($p0,$p1,$p2){for(var $0=$p1;$0<=$p2;$0++){$p0[$0]=true;}},onCommentPosted:null,$15:function($p0){this.$16([$p0]);},$16:function($p0){this.appendComments($p0);this.set_totalComments(this.get_totalComments()+$p0.length);this.$17($p0[$p0.length-1].k);this.$E();},$17:function($p0){if($p0>this.get_lastKnownCommentK()){this.set_lastKnownCommentK($p0);}},createPublicThread:function(currentParentObjectType,currentParentObjectK,duplicateGuid,rawCommentHtml,formatting,isNews,inviteUsrOptions){Js.Controls.CommentsDisplay.Service.createPublicThread(currentParentObjectType,currentParentObjectK,duplicateGuid,rawCommentHtml,formatting,isNews,inviteUsrOptions,ss.Delegate.create(this,this.$18),null,null,-1);},$18:function($p0,$p1,$p2){Js.Library.Misc.hideWaitingCursor();if($p0!=null){if(!this.$1){this.$1=$p0.threadK;}if(this.onCommentPosted!=null){this.onCommentPosted(null,new Js.Library.IntEventArgs(this.$1));}if(this.onThreadCreated!=null){this.onThreadCreated(null,new Js.Library.IntEventArgs(this.$1));}this.$15($p0);}},createNewPublicThread:function(currentParentObjectType,currentParentObjectK,duplicateGuid,rawCommentHtml,formatting,isNews,inviteUsrOptions){Js.Controls.CommentsDisplay.Service.createNewPublicThread(currentParentObjectType,currentParentObjectK,duplicateGuid,rawCommentHtml,formatting,isNews,inviteUsrOptions,ss.Delegate.create(this,this.$19),null,null,-1);},$19:function($p0,$p1,$p2){Js.Library.Misc.hideWaitingCursor();Js.Library.Misc.redirect($p0);},createReply:function(currentParentObjectType,currentParentObjectK,currentThreadK,duplicateGuid,rawCommentHtml,formatting,currentThreadLastKnownCommentK,inviteUsrOptions){Js.Controls.CommentsDisplay.Service.createReply(currentParentObjectType,currentParentObjectK,currentThreadK,duplicateGuid,rawCommentHtml,formatting,currentThreadLastKnownCommentK,inviteUsrOptions,ss.Delegate.create(this,this.$1A),Js.Library.Trace.webServiceFailure,null,-1);},$1A:function($p0,$p1,$p2){Js.Library.Misc.hideWaitingCursor();if($p0!=null){this.$16($p0);if(this.onCommentPosted!=null){this.onCommentPosted(this,ss.EventArgs.Empty);}Js.Library.Misc.redirectToAnchor('Anchor-CommentK-'+$p0[0].k);}},reloadComments:function(){this.$3=[];this.$4=[];this.$6=[];this.loadThreadComments();},decrementCurrentThreadTotalComments:function(){this.set_totalComments(this.get_totalComments()-1)+1;}}
Js.Controls.CommentsDisplay.View=function(clientId){this.clientId=clientId;}
Js.Controls.CommentsDisplay.View.prototype={clientId:null,get_uiInitialCommentPanel:function(){if(this.$0==null){this.$0=document.getElementById(this.clientId+'_uiInitialCommentPanel');}return this.$0;},$0:null,get_uiInitialCommentPanelJ:function(){if(this.$1==null){this.$1=$('#'+this.clientId+'_uiInitialCommentPanel');}return this.$1;},$1:null,get_initialCommentH1:function(){if(this.$2==null){this.$2=document.getElementById(this.clientId+'_InitialCommentH1');}return this.$2;},$2:null,get_initialCommentH1J:function(){if(this.$3==null){this.$3=$('#'+this.clientId+'_InitialCommentH1');}return this.$3;},$3:null,get_uiInitialComment:function(){if(this.$4==null){this.$4=document.getElementById(this.clientId+'_uiInitialComment');}return this.$4;},$4:null,get_uiInitialCommentJ:function(){if(this.$5==null){this.$5=$('#'+this.clientId+'_uiInitialComment');}return this.$5;},$5:null,get_uiInitialCommentDataList:function(){if(this.$6==null){this.$6=document.getElementById(this.clientId+'_uiInitialCommentDataList');}return this.$6;},$6:null,get_uiInitialCommentDataListJ:function(){if(this.$7==null){this.$7=$('#'+this.clientId+'_uiInitialCommentDataList');}return this.$7;},$7:null,get_uiCommentsAnchor:function(){if(this.$8==null){this.$8=document.getElementById(this.clientId+'_uiCommentsAnchor');}return this.$8;},$8:null,get_uiCommentsAnchorJ:function(){if(this.$9==null){this.$9=$('#'+this.clientId+'_uiCommentsAnchor');}return this.$9;},$9:null,get_uiCommentsPanel:function(){if(this.$A==null){this.$A=document.getElementById(this.clientId+'_uiCommentsPanel');}return this.$A;},$A:null,get_uiCommentsPanelJ:function(){if(this.$B==null){this.$B=$('#'+this.clientId+'_uiCommentsPanel');}return this.$B;},$B:null,get_commentsSubjectH1:function(){if(this.$C==null){this.$C=document.getElementById(this.clientId+'_CommentsSubjectH1');}return this.$C;},$C:null,get_commentsSubjectH1J:function(){if(this.$D==null){this.$D=$('#'+this.clientId+'_CommentsSubjectH1');}return this.$D;},$D:null,get_uiCommentsPanelClientSide:function(){if(this.$E==null){this.$E=document.getElementById(this.clientId+'_uiCommentsPanelClientSide');}return this.$E;},$E:null,get_uiCommentsPanelClientSideJ:function(){if(this.$F==null){this.$F=$('#'+this.clientId+'_uiCommentsPanelClientSide');}return this.$F;},$F:null,get_uiCommentsPanelServerSide:function(){if(this.$10==null){this.$10=document.getElementById(this.clientId+'_uiCommentsPanelServerSide');}return this.$10;},$10:null,get_uiCommentsPanelServerSideJ:function(){if(this.$11==null){this.$11=$('#'+this.clientId+'_uiCommentsPanelServerSide');}return this.$11;},$11:null,get_commentsPageP1:function(){if(this.$12==null){this.$12=document.getElementById(this.clientId+'_CommentsPageP1');}return this.$12;},$12:null,get_commentsPageP1J:function(){if(this.$13==null){this.$13=$('#'+this.clientId+'_CommentsPageP1');}return this.$13;},$13:null,get_commentsPrevPageLink1:function(){if(this.$14==null){this.$14=document.getElementById(this.clientId+'_CommentsPrevPageLink1');}return this.$14;},$14:null,get_commentsPrevPageLink1J:function(){if(this.$15==null){this.$15=$('#'+this.clientId+'_CommentsPrevPageLink1');}return this.$15;},$15:null,get_commentsNextPageLink1:function(){if(this.$16==null){this.$16=document.getElementById(this.clientId+'_CommentsNextPageLink1');}return this.$16;},$16:null,get_commentsNextPageLink1J:function(){if(this.$17==null){this.$17=$('#'+this.clientId+'_CommentsNextPageLink1');}return this.$17;},$17:null,get_commentsPagesP1:function(){if(this.$18==null){this.$18=document.getElementById(this.clientId+'_CommentsPagesP1');}return this.$18;},$18:null,get_commentsPagesP1J:function(){if(this.$19==null){this.$19=$('#'+this.clientId+'_CommentsPagesP1');}return this.$19;},$19:null,get_commentsDataList:function(){if(this.$1A==null){this.$1A=document.getElementById(this.clientId+'_CommentsDataList');}return this.$1A;},$1A:null,get_commentsDataListJ:function(){if(this.$1B==null){this.$1B=$('#'+this.clientId+'_CommentsDataList');}return this.$1B;},$1B:null,get_commentsPagesP2:function(){if(this.$1C==null){this.$1C=document.getElementById(this.clientId+'_CommentsPagesP2');}return this.$1C;},$1C:null,get_commentsPagesP2J:function(){if(this.$1D==null){this.$1D=$('#'+this.clientId+'_CommentsPagesP2');}return this.$1D;},$1D:null,get_commentsPageP2:function(){if(this.$1E==null){this.$1E=document.getElementById(this.clientId+'_CommentsPageP2');}return this.$1E;},$1E:null,get_commentsPageP2J:function(){if(this.$1F==null){this.$1F=$('#'+this.clientId+'_CommentsPageP2');}return this.$1F;},$1F:null,get_commentsPrevPageLink:function(){if(this.$20==null){this.$20=document.getElementById(this.clientId+'_CommentsPrevPageLink');}return this.$20;},$20:null,get_commentsPrevPageLinkJ:function(){if(this.$21==null){this.$21=$('#'+this.clientId+'_CommentsPrevPageLink');}return this.$21;},$21:null,get_commentsNextPageLink:function(){if(this.$22==null){this.$22=document.getElementById(this.clientId+'_CommentsNextPageLink');}return this.$22;},$22:null,get_commentsNextPageLinkJ:function(){if(this.$23==null){this.$23=$('#'+this.clientId+'_CommentsNextPageLink');}return this.$23;},$23:null,get_uiPageNumber:function(){if(this.$24==null){this.$24=document.getElementById(this.clientId+'_uiPageNumber');}return this.$24;},$24:null,get_uiPageNumberJ:function(){if(this.$25==null){this.$25=$('#'+this.clientId+'_uiPageNumber');}return this.$25;},$25:null,get_uiClientID:function(){if(this.$26==null){this.$26=document.getElementById(this.clientId+'_uiClientID');}return this.$26;},$26:null,get_uiClientIDJ:function(){if(this.$27==null){this.$27=$('#'+this.clientId+'_uiClientID');}return this.$27;},$27:null,get_uiCommentsPerPage:function(){if(this.$28==null){this.$28=document.getElementById(this.clientId+'_uiCommentsPerPage');}return this.$28;},$28:null,get_uiCommentsPerPageJ:function(){if(this.$29==null){this.$29=$('#'+this.clientId+'_uiCommentsPerPage');}return this.$29;},$29:null,get_uiUsrIsLoggedIn:function(){if(this.$2A==null){this.$2A=document.getElementById(this.clientId+'_uiUsrIsLoggedIn');}return this.$2A;},$2A:null,get_uiUsrIsLoggedInJ:function(){if(this.$2B==null){this.$2B=$('#'+this.clientId+'_uiUsrIsLoggedIn');}return this.$2B;},$2B:null}
Js.Controls.CommentsDisplay.CommentStub=function(){}
Js.Controls.CommentsDisplay.CommentStub.prototype={k:0,usrUrl:null,usrK:0,usrRollover:null,usrPicSrc:null,usrName:null,isNew:false,html:null,script:null,lolHtml:null,haveAlreadyLold:false,friendlyTimeNoCaps:null,editLinkVisible:false,editedHtml:null,deleteLinkVisible:false,deleteLinkOnClickConfirmText:null,threadK:0}
Js.Controls.CommentsDisplay.CommentResult=function(){}
Js.Controls.CommentsDisplay.CommentResult.prototype={initialComment:null,comments:null,lastPage:0,currentPage:0,firstUnreadPage:0,viewComments:0,totalComments:0}
Js.Controls.CommentsDisplay.Controller=function(view){this.$0=view;this.threadCommentsProvider=new Js.Controls.CommentsDisplay.ThreadCommentsProvider(this.get_$6());this.threadCommentsProvider.commentsAnchorName=view.get_uiCommentsAnchor().getAttribute('name');this.threadCommentsProvider.onLoaded=ss.Delegate.create(this,this.$A);this.$7();this.$2=document.createElement('center');view.get_uiCommentsPanelClientSide().appendChild(this.$2);this.$3=document.createElement('div');this.$3.style.textAlign='right';view.get_uiCommentsPanelClientSide().appendChild(this.$3);this.$4=document.createElement('div');view.get_uiCommentsPanelClientSide().appendChild(this.$4);this.$5=document.createElement('div');this.$5.style.textAlign='right';view.get_uiCommentsPanelClientSide().appendChild(this.$5);}
Js.Controls.CommentsDisplay.Controller.$F=function($p0){for(var $0=0;$0<$p0.childNodes.length;$0++){$p0.removeChild($p0.childNodes[$0]);}$p0.innerHTML='';}
Js.Controls.CommentsDisplay.Controller.prototype={$0:null,threadCommentsProvider:null,get_$1:function(){return this.$0.get_uiClientID().value+'_controls_';},$2:null,$3:null,$4:null,$5:null,get_$6:function(){return parseInt(this.$0.get_uiCommentsPerPage().value);},$7:function(){if(this.$0.get_uiInitialCommentDataList()!=null){this.$0.get_uiInitialCommentDataList().style.display='none';}this.$0.get_uiCommentsPanelServerSide().style.display='none';this.$0.get_uiCommentsPanelClientSide().style.display='';},setCommentsCount:function(commentsCount){if(!commentsCount){this.$2.innerHTML='<p>No comments</p>';this.$0.get_uiInitialCommentPanel().style.display='none';this.$0.get_uiCommentsPanel().style.display='none';}else{this.$2.innerHTML=(commentsCount===1)?'<p>1 comment loading...</p>':'<p>'+commentsCount+' comments loading...</p>';this.$0.get_uiCommentsPanelClientSide().style.display='';this.$0.get_uiCommentsPanel().style.display='';}this.$8(false);this.$2.style.display='';},$8:function($p0){var $0=($p0)?'':'none';var $1=($p0&&this.threadCommentsProvider.get_lastPage()>1)?'':'none';this.$3.style.display=$1;this.$4.style.display=$0;this.$5.style.display=$1;if($p0){this.$0.get_uiCommentsPanel().style.display='';}},$9:function(){this.$2.style.display='none';},showComments:function(threadK,pageNumber){this.threadCommentsProvider.set_threadK(threadK);this.threadCommentsProvider.set_pageNumber(pageNumber);this.threadCommentsProvider.loadThreadComments();},onCommentsDisplayed:null,$A:function($p0,$p1){if(this.threadCommentsProvider.get_totalComments()>0){this.$B();}else{this.$0.get_uiCommentsPanel().style.display='none';}if(this.onCommentsDisplayed!=null){this.onCommentsDisplayed(this,$p1);}},$B:function(){this.$10();this.$E();this.$0.get_uiCommentsPanelClientSide().style.display='';this.$C();this.$9();},$C:function(){Js.Controls.CommentsDisplay.Controller.$F(this.$4);this.$8(true);var $0=this.threadCommentsProvider.get_comments();for(var $1=0;$1<$0.length;$1++){this.$D($0[$1]);}for(var $2=0;$2<$0.length;$2++){try{eval($0[$2].script);}catch($3){}}},$D:function($p0){this.$4.appendChild(this.$16($p0));this.$4.appendChild(this.$17($p0));},$E:function(){if(this.threadCommentsProvider.get_lastPage()===1){this.$3.style.display='none';this.$5.style.display='none';return;}this.$3.style.display='';Js.Controls.CommentsDisplay.Controller.$F(this.$3);this.$3.appendChild(this.threadCommentsProvider.createPrevNextPaging());this.$3.appendChild(this.threadCommentsProvider.createNumberedPaging());this.$3.style.display='';Js.Controls.CommentsDisplay.Controller.$F(this.$5);this.$5.appendChild(this.threadCommentsProvider.createNumberedPaging());this.$5.appendChild(this.threadCommentsProvider.createPrevNextPaging());},$10:function(){if(this.threadCommentsProvider.get_initialComment()!=null&&this.threadCommentsProvider.get_pageNumber()>1){this.$0.get_uiInitialCommentPanel().style.display='';this.$0.get_uiInitialComment().style.display='';for(var $0=0;$0<this.$0.get_uiInitialComment().childNodes.length;$0++){this.$0.get_uiInitialComment().removeChild(this.$0.get_uiInitialComment().childNodes[$0]);}this.$0.get_uiInitialComment().appendChild(this.$17(this.threadCommentsProvider.get_initialComment()));this.$11('Replies');}else{this.$0.get_uiInitialCommentPanel().style.display='none';this.$11('Comments');}},$11:function($p0){this.$0.get_commentsSubjectH1().childNodes[0].innerHTML=$p0;},$12:function($p0,$p1){document.getElementById(this.$14($p0)).style.display='none';(document.getElementById(this.$15($p0))).innerHTML=$p1;},$13:function($p0){return this.get_$1()+'C'+$p0;},$14:function($p0){return this.get_$1()+'L'+$p0;},$15:function($p0){return this.get_$1()+'H'+$p0;},$16:function($p0){var $0=document.createElement('a');$0.id='Anchor-CommentK-'+$p0.k;return $0;},$17:function($p0){var $0=document.createElement('div');$0.className='CommentOuter ClearAfter';$0.appendChild(this.$18($p0));$0.appendChild(this.$19($p0));return $0;},$18:function($p0){var $0=document.createElement('div');$0.className='CommentLeft';var $1=document.createElement('a');$1.href=$p0.usrUrl;this.$1A($($1),$p0.usrRollover,'htm();');var $2=document.createElement('img');$2.src=$p0.usrPicSrc;$2.style.width='100px';$2.style.height='100px';$2.style.marginBottom='2px';$2.style.marginTop='0px';$2.className='BorderBlack All Block';$1.appendChild($2);$0.appendChild($1);var $3=document.createElement('a');$3.href=$p0.usrUrl;$3.innerHTML=$p0.usrName;$0.appendChild($3);return $0;},$19:function($p0){var $0=document.createElement('div');$0.className='CommentBody';$0.innerHTML=(($p0.isNew)?'<a name="Unread"></a><span class="Unread">NEW</span> ':'')+$p0.html;var $1=document.createElement('div');$1.className='CommentAdmin';var $2=document.createElement('small');var $3=document.createElement('span');$3.className='CleanLinks';$3.innerHTML=$p0.lolHtml;$3.id=this.$15($p0.k);$2.appendChild($3);if(!$p0.haveAlreadyLold&&Boolean.parse(this.$0.get_uiUsrIsLoggedIn().value)){$2.appendChild(document.createTextNode(' '));var $7=document.createElement('div');var $8=document.createElement('a');$8.href='#';$8.innerHTML='This made me laugh!';$8.setAttribute(Js.Controls.CommentsDisplay._Properties.$1,$p0.k);$($8).click(ss.Delegate.create(this,this.$1B));$7.appendChild($8);$7.id=this.$14($p0.k);$2.appendChild($7);}$2.appendChild(document.createTextNode(' '));var $4=document.createElement('a');$4.href='#PostComment';$4.innerHTML='Reply';$2.appendChild($4);$2.appendChild(document.createTextNode(' '));var $5=document.createElement('a');$5.innerHTML='Quote';$5.href='#';$($5).mousedown(ss.Delegate.create(this,this.$1D)).click(ss.Delegate.create(this,this.$1E));$5.setAttribute(Js.Controls.CommentsDisplay._Properties.$2,$p0.usrK);$2.appendChild($5);if($p0.editLinkVisible){$2.appendChild(document.createTextNode(' '));var $9=document.createElement('a');$9.innerHTML='Edit';$9.href='/pages/commentedit/k-'+$p0.k;$2.appendChild($9);}if($p0.deleteLinkVisible){$2.appendChild(document.createTextNode(' '));var $A=document.createElement('a');$A.innerHTML='Delete';$A.href='#';$($A).click(ss.Delegate.create(this,this.$1F));$A.setAttribute(Js.Controls.CommentsDisplay._Properties.$0,$p0.deleteLinkOnClickConfirmText);$A.setAttribute(Js.Controls.CommentsDisplay._Properties.$1,$p0.k);$2.appendChild($A);}$2.appendChild(document.createElement('br'));var $6=document.createElement('span');this.$1A($($6),"stt('"+$p0.k+"');",'htm();');$6.innerHTML='Posted '+$p0.friendlyTimeNoCaps;$2.appendChild($6);if($p0.editedHtml!=null&&$p0.editedHtml.length>0){var $B=document.createElement('span');$B.innerHTML=$p0.editedHtml;$2.appendChild($B);}$1.appendChild($2);$0.appendChild($1);return $0;},$1A:function($p0,$p1,$p2){$p0.removeAttr('onmouseover').removeAttr('onmouseout').mouseover(function($p1_0){
eval($p1);}).mouseout(function($p1_0){
eval($p2);});},$1B:function($p0){$p0.preventDefault();var $0=$p0.target.getAttribute(Js.Controls.CommentsDisplay._Properties.$1);Js.Controls.CommentsDisplay.Service.lolAtComment($0,ss.Delegate.create(this,this.$1C),Js.Library.Trace.webServiceFailure,$0,-1);},$1C:function($p0,$p1,$p2){this.$12($p1,$p0);},$1D:function($p0){$p0.preventDefault();var $0=$p0.target.getAttribute(Js.Controls.CommentsDisplay._Properties.$2);eval('QuoteNow('+$0.toString()+');');},$1E:function($p0){$p0.preventDefault();eval('FocusNow();');},$1F:function($p0){$p0.preventDefault();Js.Library.Misc.showWaitingCursor();if(confirm($p0.target.getAttribute(Js.Controls.CommentsDisplay._Properties.$0))){var $0=$p0.target.getAttribute(Js.Controls.CommentsDisplay._Properties.$1);Js.Controls.CommentsDisplay.Service.deleteComment($0,ss.Delegate.create(this,this.$20),ss.Delegate.create(this,this.$21),$0,-1);}},onThreadDeleted:null,$20:function($p0,$p1,$p2){Js.Library.Misc.hideWaitingCursor();if($p0){if(this.threadCommentsProvider.get_totalComments()===1){if(this.onThreadDeleted!=null){this.onThreadDeleted(this,new Js.Library.IntEventArgs(this.threadCommentsProvider.get_threadK()));}this.threadCommentsProvider.set_threadK(0);this.$0.get_uiCommentsPanel().style.display='none';}this.threadCommentsProvider.decrementCurrentThreadTotalComments();this.threadCommentsProvider.reloadComments();}},$21:function($p0,$p1,$p2){Js.Library.Misc.hideWaitingCursor();}}
Js.Controls.CommentsDisplay._Properties=function(){}
Js.Controls.CommentsDisplay.Service.registerClass('Js.Controls.CommentsDisplay.Service');Js.Controls.CommentsDisplay.ThreadCommentsProvider.registerClass('Js.Controls.CommentsDisplay.ThreadCommentsProvider');Js.Controls.CommentsDisplay.View.registerClass('Js.Controls.CommentsDisplay.View');Js.Controls.CommentsDisplay.CommentStub.registerClass('Js.Controls.CommentsDisplay.CommentStub');Js.Controls.CommentsDisplay.CommentResult.registerClass('Js.Controls.CommentsDisplay.CommentResult');Js.Controls.CommentsDisplay.Controller.registerClass('Js.Controls.CommentsDisplay.Controller');Js.Controls.CommentsDisplay._Properties.registerClass('Js.Controls.CommentsDisplay._Properties');Js.Controls.CommentsDisplay._Properties.$0='ConfirmText';Js.Controls.CommentsDisplay._Properties.$1='CommentK';Js.Controls.CommentsDisplay._Properties.$2='UsrK';})(jQuery);// This script was generated using Script# v0.7.4.0
