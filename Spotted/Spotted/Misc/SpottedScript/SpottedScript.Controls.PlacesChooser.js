Type.registerNamespace('SpottedScript.Controls.PlacesChooser');
SpottedScript.Controls.PlacesChooser.Controller=function(view){this.view=view;$addHandler(view.get_uiAddRadiusButton(),'click',Function.createDelegate(this,this.$0));this.$1();GEvent.addListener(this.view.get_uiMap().gmap2,'moveend',Function.createDelegate(this,this.$1));GEvent.addListener(this.view.get_uiMap().gmap2,'zoomend',Function.createDelegate(this,this.$1));}
SpottedScript.Controls.PlacesChooser.Controller.prototype={view:null,$0:function($p0){try{Spotted.WebServices.Controls.PlacesChooser.Service.getSurroundingPlaces(Number.parseInvariant(this.view.get_uiRadiusPlaceAutoComplete().get_value()),Number.parseInvariant(this.view.get_uiNumberOfSurroundingTownsDropDown().value),Function.createDelegate(this,function($p1_0,$p1_1,$p1_2){
for(var $1_0=0;$1_0<$p1_0.length;$1_0++){this.view.get_uiPlacesMultiSelector().addItem($p1_0[$1_0].name,$p1_0[$1_0].k.toString());}this.view.get_uiRadiusPlaceAutoComplete().clear();}),Function.createDelegate(null,Utils.Trace.webServiceFailure),null,5000);}catch($0){}$p0.preventDefault();},$1:function(){var $0=this.view.get_uiMap().gmap2.getBounds();Spotted.WebServices.Controls.PlacesChooser.Service.getPlaces($0.getNorthEast().lat(),$0.getSouthWest().lat(),$0.getNorthEast().lng(),$0.getSouthWest().lng(),20,Function.createDelegate(this,this.$3),Function.createDelegate(null,Utils.Trace.webServiceFailure),null,3000);},$2:null,$3:function($p0,$p1,$p2){if(this.$2!=null){for(var $0=0;$0<this.$2.length;$0++){GEvent.clearListeners(this.$2[$0],'click');GEvent.clearListeners(this.$2[$0],'onmouseover');GEvent.clearListeners(this.$2[$0],'onmouseout');}}this.view.get_uiMap().gmap2.clearOverlays();this.$2=[];for(var $1=0;$1<$p0.length;$1++){var $2=$p0[$1];this.$4($2.lat,$2.lng,$2.name,$2.k);}},$4:function($p0,$p1,$p2,$p3){var $0=new GLatLng($p0,$p1,true);var $1=new GMarker($0);$1.k = $p3;;$1.name = $p2;;GEvent.addListener($1,'click',Function.createDelegate(this,function(){
this.view.get_uiPlacesMultiSelector().addItem($p2,$p3.toString());}));GEvent.addListener($1,'mouseover',Function.createDelegate(this,function(){
stt($p2);;}));GEvent.addListener($1,'mouseout',Function.createDelegate(this,function(){
try{htm();;}catch($1_0){}}));this.view.get_uiMap().gmap2.addOverlay($1);this.$2[this.$2.length]=$1;}}
SpottedScript.Controls.PlacesChooser.PlaceStub=function(){}
SpottedScript.Controls.PlacesChooser.PlaceStub.prototype={k:0,name:null,lat:0,lng:0}
SpottedScript.Controls.PlacesChooser.View=function(clientId){this.clientId=clientId;}
SpottedScript.Controls.PlacesChooser.View.prototype={clientId:null,get_uiPlacesMultiSelector:function(){return eval(this.clientId+'_uiPlacesMultiSelectorBehaviour');},get_uiMap:function(){return eval(this.clientId+'_uiMapController');},get_uiPlacesRadius:function(){return document.getElementById(this.clientId+'_uiPlacesRadius');},get_uiNumberOfSurroundingTownsDropDown:function(){return document.getElementById(this.clientId+'_uiNumberOfSurroundingTownsDropDown');},get_uiRadiusPlaceAutoComplete:function(){return eval(this.clientId+'_uiRadiusPlaceAutoCompleteBehaviour');},get_uiAddRadiusButton:function(){return document.getElementById(this.clientId+'_uiAddRadiusButton');}}
SpottedScript.Controls.PlacesChooser.Controller.registerClass('SpottedScript.Controls.PlacesChooser.Controller');
SpottedScript.Controls.PlacesChooser.PlaceStub.registerClass('SpottedScript.Controls.PlacesChooser.PlaceStub');
SpottedScript.Controls.PlacesChooser.View.registerClass('SpottedScript.Controls.PlacesChooser.View');
