Type.registerNamespace('SpottedScript.Controls.VenueGetter');
SpottedScript.Controls.VenueGetter.Controller=function(view){this.$0=view;this.$1=view.get_uiAuto().transformReceivedSuggestions;view.get_uiAuto().transformReceivedSuggestions=Function.createDelegate(this,this.$6);this.$2=view.get_uiAuto().itemChosen;view.get_uiAuto().itemChosen=Function.createDelegate(this,this.$5);view.get_uiAuto().parameters.set('returnInfo',true);$addHandler(view.get_uiSelectedItemPanel(),'click',Function.createDelegate(this,this.$3));SpottedScript.Misc.addHoverText(view.get_uiSelectedItemPanel(),'Click here to change');}
SpottedScript.Controls.VenueGetter.Controller.prototype={$0:null,$1:null,$2:null,$3:function($p0){this.$7();this.$0.get_uiAuto().requestSuggestions();},setVenue:function(venueInfo){if(venueInfo!=null){this.$0.get_uiSelectedItemPanel().style.display='';this.$0.get_uiSelectedItemPanel().innerHTML=ScriptSharpLibrary.Suggestion.getPicTitleDetailTemplateHtml(venueInfo.picPath,venueInfo.name,SpottedScript.Controls.VenueCreator.PlaceInfo.nameWithCountry(venueInfo.place));this.$0.get_uiAuto().set_text(venueInfo.name+', '+venueInfo.place.name+', '+venueInfo.place.country.name);this.$0.get_uiAuto().set_value(Sys.Serialization.JavaScriptSerializer.serialize(venueInfo));this.$0.get_uiAuto().$4.style.display='none';this.$0.get_uiSelectedItemPanel().style.display='';}else{this.$0.get_uiAuto().$4.style.display='';this.$0.get_uiSelectedItemPanel().style.display='none';this.$0.get_uiAuto().set_text('');this.$0.get_uiAuto().set_value('');}},$4:function(){try{return Sys.Serialization.JavaScriptSerializer.deserialize(this.$0.get_uiAuto().get_value());}catch($0){return null;}},$5:function($p0){if($p0.value.startsWith('|create|')){var $0=$p0.value.split('|');var $1=$0[$0.length-1];SpottedScript.Controls.VenueCreator.Controller.$2.createVenue($1,null,Function.createDelegate(this,this.setVenue));}else{this.setVenue(Sys.Serialization.JavaScriptSerializer.deserialize($p0.value));if(this.$2!=null){this.$2($p0);}}},$6:function($p0,$p1){if(this.$1!=null){$p0=this.$1($p0,$p1);}if(this.$0.get_uiAuto().get_text()!==''&&this.$0.get_uiAuto().get_value()==null){var $0=new ScriptSharpLibrary.Suggestion();$0.html=ScriptSharpLibrary.Suggestion.getPicTitleDetailTemplateHtml('/gfx/icon40-eventcreator-add.png','Add <b>'+this.$0.get_uiAuto().get_text()+'</b>','Other people will be able to add details about the venue later');$0.value='|create|'+this.$0.get_uiAuto().get_text()+'';$0.text=$0.value;ScriptSharpLibrary.Suggestion.addSuggestion($p0,$0,$p1);}return $p0;},$7:function(){this.$0.get_uiAuto().$4.style.display='';this.$0.get_uiSelectedItemPanel().style.display='none';this.$0.get_uiAuto().focus();}}
SpottedScript.Controls.VenueGetter.View=function(clientId){this.clientId=clientId;}
SpottedScript.Controls.VenueGetter.View.prototype={clientId:null,get_uiOuterPanel:function(){return document.getElementById(this.clientId+'_uiOuterPanel');},get_uiAuto:function(){return eval(this.clientId+'_uiAutoBehaviour');},get_uiSelectedItemPanel:function(){return document.getElementById(this.clientId+'_uiSelectedItemPanel');}}
SpottedScript.Controls.VenueGetter.Controller.registerClass('SpottedScript.Controls.VenueGetter.Controller');
SpottedScript.Controls.VenueGetter.View.registerClass('SpottedScript.Controls.VenueGetter.View');
