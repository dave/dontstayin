Type.registerNamespace('SpottedScript.MixmagGreatest.Home');
function FacebookReady(){SpottedScript.MixmagGreatest.Home.Controller.instance.facebookReady();}
SpottedScript.MixmagGreatest.Home.Controller=function(v){this.$1B={};SpottedScript.MixmagGreatest.Home.Controller.instance=this;this.view=v;this.server=v.server;if(SpottedScript.Misc.get_browserIsIE()){jQuery(document.body).ready(Function.createDelegate(this,this.$6));}else{this.$6();}}
SpottedScript.MixmagGreatest.Home.Controller.prototype={view:null,server:null,$0:0,$1:false,$2:null,$3:0,$4:false,$5:false,$6:function(){this.$0=Number.parseInvariant(this.view.get_pageIdToLike().value);this.$1=Boolean.parse(this.view.get_likedPage().value);this.$3=Number.parseInvariant(this.view.get_mixmagGreatestDjK().value);this.$2=this.view.get_facebookSource().value;this.$4=Boolean.parse(this.view.get_safariKludge().value);$addHandler(this.view.get_voteButton(),'click',Function.createDelegate(this,this.$8));$addHandler(this.view.get_confirm_YesButton(),'click',Function.createDelegate(this,this.$C));$addHandler(this.view.get_confirm_NoButton(),'click',Function.createDelegate(this,this.$D));$addHandler(this.view.get_loggedOutButton(),'click',Function.createDelegate(this,this.$E));this.$5=true;this.facebookReady();},facebookReady:function(){if(this.$5&&eval('DoneFbAsyncInit')){FB.Event.subscribe('auth.statusChange',Function.createDelegate(this,function($p1_0){
this.$18($p1_0);}));FB.getLoginStatus(Function.createDelegate(this,function($p1_0){
this.$18($p1_0);this.$12=this.$13;this.$16=this.$15;}));FB.Event.subscribe('edge.create',Function.createDelegate(this,function($p1_0){
this.$F();}));this.$7();}},$7:function(){if(this.$3===0){this.$11(this.view.get_nominationsPanel());}else{this.view.get_voteButtonPrompt().innerHTML=(this.$1)?'Step 1 - click the Vote button:':'Step 2 - click the Vote button:';this.$11(this.view.get_votePanel());}},$8:function($p0){this.debug('ButtonClick');$p0.preventDefault();if(this.$13&&this.$14){this.$B();}else{this.$9();}},$9:function(){var $0=this.$1D('Connecting...',false,false);FB.login(Function.createDelegate(this,function($p1_0){
if(this.$1E($0)){return;}if(this.$14){this.$B();}else{this.$1F('Looks like Facebook had trouble getting you connected.');}}),F.d('scope','publish_stream'));},$A:false,$B:function(){this.debug('confirmFacebookAccount');if(this.$12&&!this.$A){var $0=this.$1C('Loading...');FB.api('/me',Function.createDelegate(this,function($p1_0){
if(this.$1E($0)){return;}this.view.get_confirm_Link().innerHTML=ImportedUtilities.U.get($p1_0,'name').toString();this.view.get_confirm_Link().href=ImportedUtilities.U.get($p1_0,'link').toString();this.view.get_confirm_Img().src='http://graph.facebook.com/'+ImportedUtilities.U.get($p1_0,'id').toString()+'/picture';this.view.get_voteLikeHolder().style.display='none';this.view.get_voteButtonHolder().style.display='none';this.view.get_voteConfirmHolder().style.display='';this.view.get_voteLoggedOutHolder().style.display='none';}));}else{this.$10();}},$C:function($p0){$p0.preventDefault();this.$A=true;this.$10();},$D:function($p0){$p0.preventDefault();this.$A=true;var $0=this.$1C('Logging out...');FB.logout(Function.createDelegate(this,function($p1_0){
if(this.$1E($0)){return;}this.view.get_voteLikeHolder().style.display='none';this.view.get_voteButtonHolder().style.display='none';this.view.get_voteConfirmHolder().style.display='none';this.view.get_voteLoggedOutHolder().style.display='';}));},$E:function($p0){$p0.preventDefault();this.$9();},$F:function(){this.$1=true;this.view.get_nominationsHolder().style.display='';this.view.get_nominationsLikeButtonHolder().style.display='none';this.view.get_voteLikeHolder().style.display='none';this.view.get_voteButtonHolder().style.display='';this.view.get_voteConfirmHolder().style.display='none';this.view.get_voteLoggedOutHolder().style.display='none';},$10:function(){var $0=this.$1C('Voting...');this.server.voteNow(this.$3,this.$2,this.view.get_voteFacebookUpdateCheckbox1().checked,Function.createDelegate(this,function($p1_0){
if(this.$1E($0)){return;}if(ImportedUtilities.U.isTrue($p1_0,'Exception')){this.$1F('Looks like we had a problem...');}else if(!ImportedUtilities.U.isTrue($p1_0,'Done')){this.$1F(ImportedUtilities.U.get($p1_0,'Message').toString());}else{FB.Canvas.scrollTo(0,0);this.$11(this.view.get_voteCompletePanel());}}));},$11:function($p0){this.view.get_nominationsPanel().style.display=($p0===this.view.get_nominationsPanel())?'':'none';this.view.get_votePanel().style.display=($p0===this.view.get_votePanel())?'':'none';this.view.get_voteCompletePanel().style.display=($p0===this.view.get_voteCompletePanel())?'':'none';},$12:false,$13:false,$14:false,$15:'0',$16:'0',$17:null,$18:function($p0){this.$14=ImportedUtilities.U.exists($p0,'status')&&ImportedUtilities.U.get($p0,'status').toString()==='connected';this.$13=ImportedUtilities.U.exists($p0,'status')&&ImportedUtilities.U.get($p0,'status').toString()!=='unknown';this.$15=(this.$14)?ImportedUtilities.U.get($p0,'authResponse/userID').toString():'0';this.$17=(this.$14)?ImportedUtilities.U.get($p0,'authResponse'):null;if(this.$4){if(ImportedUtilities.U.exists($p0,'authResponse')){var $0=this.$1C('Loading...');this.server.setCookie(ImportedUtilities.U.get($p0,'authResponse/signedRequest').toString(),Function.createDelegate(this,function($p1_0){
if(this.$1E($0)){return;}if(ImportedUtilities.U.isTrue($p1_0,'Exception')){this.$1F('Looks like we had a problem...');}else if(!ImportedUtilities.U.isTrue($p1_0,'Done')){this.$1F(ImportedUtilities.U.get($p1_0,'Message').toString());}else{}}));}}},debug:function(txt){this.view.get_debugOutput().innerHTML=txt+'\n'+this.view.get_debugOutput().innerHTML;},$19:false,$1A:0,$1C:function($p0){return this.$1D($p0,true,true);},$1D:function($p0,$p1,$p2){this.$19=true;this.$1A++;var $0=this.$1A;if($p2){if($p0.length>0){this.view.get_loadingLabel().innerHTML='<p>'+$p0+'<p>';}else{this.view.get_loadingLabel().innerHTML='<p>Loading...<p>';}this.view.get_loadingLabel().style.display='';}if($p1){window.setTimeout(Function.createDelegate(this,function(){
if(this.$19&&$0===this.$1A){this.view.get_loadingLabel().innerHTML='<p>This seems to be taking a long time... <button id=\"LoadingLabel_CancelLink\">Cancel</button></p>';$addHandler(document.getElementById('LoadingLabel_CancelLink'),'click',Function.createDelegate(this,function($p2_0){
$p2_0.preventDefault();this.$1B[$0.toString()]=true;this.$19=false;if(this.view.get_loadingLabel()!=null){this.view.get_loadingLabel().style.display='none';}this.$7();}));}}),5000);}return $0;},$1E:function($p0){if(this.$1B[$p0.toString()]!=null&&this.$1B[$p0.toString()]){return true;}this.$19=false;if(this.view.get_loadingLabel()!=null){this.view.get_loadingLabel().style.display='none';}return false;},$1F:function($p0){alert($p0);this.$7();}}
SpottedScript.MixmagGreatest.Home.Server=function(){}
SpottedScript.MixmagGreatest.Home.Server.prototype={setCookie:function(signedRequest,response){var $0=[signedRequest];var $1=eval('PageMethods.ClientRequest');if($1!=null){try{$1('Spotted.MixmagGreatest.Home, Spotted, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null','SetCookie',$0,response,response);}catch($2){var $3={};$3['Exception']=true;$3['ExceptionType']='ClientException';$3['Message']=$2.message;$3['StackTrace']='';response($3);}}},voteNow:function(mixmagGreatestDjK,facebookSource,facebookMessage,response){var $0=[mixmagGreatestDjK,facebookSource,facebookMessage];var $1=eval('PageMethods.ClientRequest');if($1!=null){try{$1('Spotted.MixmagGreatest.Home, Spotted, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null','VoteNow',$0,response,response);}catch($2){var $3={};$3['Exception']=true;$3['ExceptionType']='ClientException';$3['Message']=$2.message;$3['StackTrace']='';response($3);}}}}
SpottedScript.MixmagGreatest.Home.View=function(clientId){SpottedScript.MixmagGreatest.Home.View.initializeBase(this,[clientId]);this.clientId=clientId;this.server=new SpottedScript.MixmagGreatest.Home.Server();}
SpottedScript.MixmagGreatest.Home.View.prototype={clientId:null,server:null,get_pageIdToLike:function(){return document.getElementById(this.clientId+'_PageIdToLike');},get_likedPage:function(){return document.getElementById(this.clientId+'_LikedPage');},get_mixmagGreatestDjK:function(){return document.getElementById(this.clientId+'_MixmagGreatestDjK');},get_facebookSource:function(){return document.getElementById(this.clientId+'_FacebookSource');},get_signedRequest:function(){return document.getElementById(this.clientId+'_SignedRequest');},get_doneRefresh:function(){return document.getElementById(this.clientId+'_DoneRefresh');},get_safariKludge:function(){return document.getElementById(this.clientId+'_SafariKludge');},get_testP:function(){return document.getElementById(this.clientId+'_TestP');},get_nominationsPanel:function(){return document.getElementById(this.clientId+'_NominationsPanel');},get_nominationsLikeButtonHolder:function(){return document.getElementById(this.clientId+'_NominationsLikeButtonHolder');},get_nominationsHolder:function(){return document.getElementById(this.clientId+'_NominationsHolder');},get_notRunningPanel:function(){return document.getElementById(this.clientId+'_NotRunningPanel');},get_runningPanel:function(){return document.getElementById(this.clientId+'_RunningPanel');},get_publicDjsHolder:function(){return document.getElementById(this.clientId+'_PublicDjsHolder');},get_votePanel:function(){return document.getElementById(this.clientId+'_VotePanel');},get_voteImg:function(){return document.getElementById(this.clientId+'_VoteImg');},get_voteName:function(){return document.getElementById(this.clientId+'_VoteName');},get_voteDescriptionP:function(){return document.getElementById(this.clientId+'_VoteDescriptionP');},get_voteLikeHolder:function(){return document.getElementById(this.clientId+'_VoteLikeHolder');},get_voteFollowHolder:function(){return document.getElementById(this.clientId+'_VoteFollowHolder');},get_voteFollowPrompt:function(){return document.getElementById(this.clientId+'_VoteFollowPrompt');},get_voteFollowSkipLink:function(){return document.getElementById(this.clientId+'_VoteFollowSkipLink');},get_voteTwitterSkipButton:function(){return document.getElementById(this.clientId+'_VoteTwitterSkipButton');},get_voteTweetHolder:function(){return document.getElementById(this.clientId+'_VoteTweetHolder');},get_voteTweetPrompt:function(){return document.getElementById(this.clientId+'_VoteTweetPrompt');},get_voteTweetButton:function(){return document.getElementById(this.clientId+'_VoteTweetButton');},get_voteTweetSkipLink:function(){return document.getElementById(this.clientId+'_VoteTweetSkipLink');},get_voteButtonHolder:function(){return document.getElementById(this.clientId+'_VoteButtonHolder');},get_voteButtonPrompt:function(){return document.getElementById(this.clientId+'_VoteButtonPrompt');},get_voteButton:function(){return document.getElementById(this.clientId+'_VoteButton');},get_voteFacebookUpdateCheckbox1:function(){return document.getElementById(this.clientId+'_VoteFacebookUpdateCheckbox1');},get_voteConfirmHolder:function(){return document.getElementById(this.clientId+'_VoteConfirmHolder');},get_confirm_Img:function(){return document.getElementById(this.clientId+'_Confirm_Img');},get_confirm_Link:function(){return document.getElementById(this.clientId+'_Confirm_Link');},get_confirm_YesButton:function(){return document.getElementById(this.clientId+'_Confirm_YesButton');},get_confirm_NoButton:function(){return document.getElementById(this.clientId+'_Confirm_NoButton');},get_voteLoggedOutHolder:function(){return document.getElementById(this.clientId+'_VoteLoggedOutHolder');},get_loggedOutButton:function(){return document.getElementById(this.clientId+'_LoggedOutButton');},get_voteVideo1:function(){return document.getElementById(this.clientId+'_VoteVideo1');},get_voteVideo2:function(){return document.getElementById(this.clientId+'_VoteVideo2');},get_facebookComments:function(){return document.getElementById(this.clientId+'_FacebookComments');},get_voteCompletePanel:function(){return document.getElementById(this.clientId+'_VoteCompletePanel');},get_facebookComments2:function(){return document.getElementById(this.clientId+'_FacebookComments2');},get_debugOutput:function(){return document.getElementById(this.clientId+'_DebugOutput');},get_loadingLabel:function(){return document.getElementById(this.clientId+'_LoadingLabel');},get_genericContainerPage:function(){return document.getElementById(this.clientId+'_GenericContainerPage');}}
SpottedScript.MixmagGreatest.Home.Controller.registerClass('SpottedScript.MixmagGreatest.Home.Controller');
SpottedScript.MixmagGreatest.Home.Server.registerClass('SpottedScript.MixmagGreatest.Home.Server');
SpottedScript.MixmagGreatest.Home.View.registerClass('SpottedScript.MixmagGreatest.Home.View',SpottedScript.MixmagGreatestUserControl.View);
SpottedScript.MixmagGreatest.Home.Controller.instance=null;
